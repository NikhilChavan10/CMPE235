<!--<!DOCTYPE html>
<html>
    <form enctype="multipart/form-data" action="http://api.qrserver.com/v1/read-qr-code/" method="POST">
        <!-- MAX_FILE_SIZE (maximum file size in bytes) must precede the file input field used to upload the QR code image 
        <input type="hidden" name="MAX_FILE_SIZE" value="1048576" />
        <!-- The "name" of the input field has to be "file" as it is the name of the POST parameter 
        Choose QR code image to read/scan: <input name="file" type="file" />
        <input type="submit" value="Read QR code" />
    </form>
</html>
-->

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, 
            minimum-scale=1, width=device-width, height=device-height" />
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Sharebox</title>
<meta name="description" content="BlackTie.co - Free Handsome Bootstrap Themes" />      
  <meta name="keywords" content="themes, bootstrap, free, templates, bootstrap 3, freebie,">
  <meta property="og:title" content="">

  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="fancybox/jquery.fancybox-v=2.1.5.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/font-awesome.min.css" rel="stylesheet">
  
  <link rel="stylesheet" type="text/css" href="css/style.css">  
  
  <link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,600,300,200&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <style type="text/css">
 .modal{
  padding-top: 20%;
}
  </style>
  
  <link rel="prefetch" href="images/zoom.png">
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">
 
    var pictureSource;   // picture source
    var destinationType; // sets the format of returned value
    
 
        // Wait for device API libraries to load
    //
    document.addEventListener("deviceready",onDeviceReady,false);
    
    // device APIs are available
    //
   
    function QRcodeGenerator() {
      alert("Generate QR code");
    
}


function downloadFile(){
  alert("Download file now");

window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, 
    function onFileSystemSuccess(fileSystem) {
      
        fileSystem.root.getFile(
        "dummy.html", {create: true, exclusive: false}, 
        function gotFileEntry(fileEntry) {
            var sPath = fileEntry.fullPath.replace("dummy.html","");
            
            var fileTransfer = new FileTransfer();
            fileEntry.remove();
alert(sPath);
            fileTransfer.download(
                "https://www.planwallpaper.com/static/images/9-credit-1.jpg",
                sPath + "/theFile.jpg",
                function(theFile) {
                    console.log("download complete: " + theFile.toURI());
                    showLink(theFile.toURI());
                },
                function(error) {
                    console.log("download error source " + error.source);
                    console.log("download error target " + error.target);
                    console.log("upload error code: " + error.code);
                    alert("error is there");
                }

            );
        }, fail);
    }, fail);
};


function showLink(url){
        alert(url+"this is url");
        var divEl = document.getElementById("ready");
        var aElem = document.createElement("a");
        aElem.setAttribute("target", "_blank");
        aElem.setAttribute("href", url);
        aElem.appendChild(document.createTextNode("Ready! Click To Open."))
        divEl.appendChild(aElem);
 alert("complete");
    }

 
    </script>
    </head>
    <body>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="license.js"></script>
		<script type="text/javascript" src="https://cdn.rawgit.com/alexgibson/shake.js/master/shake.js"></script>
        <script type="text/javascript">

            document.addEventListener("deviceready",onDeviceReady,false);

            // device APIs are available
            function onDeviceReady() {
                alert("start app");
                //scan();
            }
            
            function success(session) {
                alert("Scanned " + session.newlyRecognizedCodes[0].symbology 
                        + " code: " + session.newlyRecognizedCodes[0].data);

                storeIntelligrapeLogo(session.newlyRecognizedCodes[0].data);
                
            }
            function failure(error) {
                alert("Failed: " + error);
            }
            function scan() {
                alert("In Scan()");               
                Scandit.License.setAppKey("DkcU/dvB3OrJd4/HYGLHA7Yz2BWVJi+teT646MEPNCI");
                var settings = new Scandit.ScanSettings();
                settings.setSymbologyEnabled(Scandit.Barcode.Symbology.EAN13, true);
                settings.setSymbologyEnabled(Scandit.Barcode.Symbology.UPC12, true);
                settings.setSymbologyEnabled(Scandit.Barcode.Symbology.EAN8, true);
                settings.setSymbologyEnabled(Scandit.Barcode.Symbology.QR, true);
                var picker = new Scandit.BarcodePicker(settings);
                picker.show(success, null, failure);
                alert("start scan");
                picker.startScanning();
            }
        
        
        //working ...
        function Redirect(imagePath) {
            alert("Redirecting to ..... " + imagePath);
            window.location="show_images.html?filepath=" + imagePath;
        }

        function storeIntelligrapeLogo(my_urls) {
            alert('start of file download');
            var url = encodeURI(my_urls);
            
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs) {
			var d = new Date();
			var n = d.getTime();
			var imagePath = 'file:///storage/sdcard0'+fs.root.fullPath + "/bluetooth/"+n+".jpg"; // full file path
			var fileTransfer = new FileTransfer();
			fileTransfer.download(url, imagePath, function(entry) {
				alert(entry.fullPath); // entry is fileEntry object
			}, function(error) {
				alert("Some error" + JSON.stringify(error));
			});
		}) 
		    
			
			}

			
		function shake()
		{
		    var shakeEvent = new Shake({threshold: 15});
			shakeEvent.start();
			window.addEventListener('shake', function(){
				alert("Shaked");
				
		var key = document.getElementById("txtArea").value;
		$.get('http://kaushikk.com/share.php', { dir : '' }, function(data) {
		storeIntelligrapeLogo(data[0].url);
				// you should now have a json encoded PHP array
				
			}, 'json');		
	
			
			}, false);

			//stop listening
			function stopShake(){
				shakeEvent.stop();
			}

			//check if shake is supported or not.
			if(!("ondevicemotion" in window)){alert("Not Supported");}

			
		}

		function share()
		{
		var key = document.getElementById("txtArea").value;
		if(key === "AX8C NQ7B"){
		$.get('http://kaushikk.com/share.php', { dir : '' }, function(data) {
		storeIntelligrapeLogo(data[0].url);
				// you should now have a json encoded PHP array
				
			}, 'json');
		alert("In share");		
		}
		else{
		alert("Wrong key value");
        }
		}
		</script>
		<button href"/share">  </button>
<div class="navbar navbar-fixed-top" data-activeslide="1">
    <div class="container">
      
      <!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      
      <div class="nav-collapse collapse navbar-responsive-collapse">
        <ul class="nav row">
         
          <li data-slide="1" class="col-12 col-sm-2"><a id="menu-link-1" href="#slide-1" title="Next Section"><span class="icon icon-user"></span> <span class="text">Send File</span></a></li>
          <li data-slide="5" class="col-12 col-sm-2"><a id="menu-link-5" href="#slide-5" title="Next Section"><span class="icon icon-gears"></span> <span class="text">Receive File</span></a></li>
         
          
        </ul>
        <div class="row">
          <div class="col-sm-2 active-menu"></div>
        </div>
      </div><!-- /.nav-collapse -->
    </div><!-- /.container -->
  </div><!-- /.navbar -->

 <div class="slide story" id="slide-1" data-slide="1" style="background-color: #002500;">
    <div class="container">
      <div id="home-row-1" class="row clearfix">
        <div class="col-12">
          <h1 class="font-semibold" style="">ShareBox <span class="font-thin">File Sharing Application</span></h1>
         
          <br>
          <br>
        </div><!-- /col-12 -->
      </div><!-- /row -->
     </div><!-- /container -->
     <div class="container">
      <h2 class="font-thin" style="padding-top:20px;"><span class="font-semibold">Sender</span></h2>
     <div class="row">
      <div class="col-xs-6">
      <div id="home-row-2" class="row clearfix" >
        <div class="col-12 col-sm-4"><div class="home-hover navigation-slide" id="CapturePhoto" ><img class="camera-btn .center-block" src="images/img_camera.png"></div><span><p>Capture Photo</p></span></div>
      </div><!-- /row -->
      </div>
      <div class="col-xs-6">
      <div id="home-row-2" class="row clearfix">
        
        <div class="col-12 col-sm-4"><div class="home-hover navigation-slide" id="SelectFromAlbum"><img class="picture-btn .center-block" style="padding-top:30px;" src="images/img_album.PNG"></div>
        <span><p>Select From Album</p></span></div>
    
      </div>
    </div>
    </div><!-- /row -->
  </div>
</div><!-- /slide1 -->


        
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" align="center">Scan QR Code</h4>
        </div>
        <div class="modal-body">
          
        <div id="theDiv" style="text-align: center;"></div>
        <p align="center">Or</p>
         <div class="modal-footer" style="text-align: center;">
            <p align="center">Share Key</p>
            <input type="text" name="sharekey" value="AX8C NQ7B" readonly>
         </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>


<div class="modal fade" id="myshareModal" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" style="align-center;">Enter Sharing Key</h4>
        </div>
        <div class="modal-body">
        <textarea id="txtArea" rows="10" cols="30"></textarea>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-info" data-dismiss="modal" onClick="share()">Done</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>

  <!-- === SLide 3 - Portfolio -->
  <div class="slide story" id="slide-5" data-slide="5">
    <div class="container">
      <h2 class="font-thin" style="padding-top:20px;"><span class="font-semibold">Receive</span></h2>
        <div class="row">
          <div class="col-xs-4">
            <div id="home-row-2" class="row clearfix">
        
              <div class="col-12 col-sm-4"><div class="home-hover navigation-slide" id="CaptureQRScan"><img class="scan-btn .center-block" src="images/img_scan1.PNG"></div><span>
              <p>Capture QR code</p></span></div>
            </div><!-- /row -->
          </div>
          <div class="col-xs-4">
            <div id="home-row-2" class="row clearfix">
              <div class="col-12 col-sm-4"><div class="home-hover navigation-slide" id="GenerateQRcode"><img class="key-btn .center-block"  style="padding-bottom:10px;padding-right:10px;" data-toggle="modal" data-target="#myshareModal" src="images/Key.png"></div><span>
              <p>Sharing Key</p></span></div>
            </div><!-- /row -->
          </div>
		  
		  <div class="col-xs-4">
            <div id="home-row-2" class="row clearfix">
        
              <div class="col-12 col-sm-4"><div class="home-hover navigation-slide" onClick="shake()" id=""><img class="shake-btn .center-block" data-toggle="modal" data-target="#imagemodal" style ="width: 100%;
    height: auto;" src="images/shake-button.png"></div><span>
              <p>Shake</p></span></div>
            </div><!-- /row -->
          </div>
		  
        </div>
    </div><!-- /container -->
  </div><!-- /slide3 -->

	<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Shake Now</h4>
      </div>
      <div class="modal-body">
        <img src="images/shake.jpg" id="imagepreview" style="width: 100%;" >
      </div>
    </div>
  </div>
</div>

  <script src="new_app.js"></script>
  <!-- === Slide 4 - Process === -->
  
    </body>

     <script src="js/html5shiv.js"></script>
  <script src="js/jquery-1.10.2.min.js"></script>
  <script src="js/jquery-migrate-1.2.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script type="text/javascript" src="fancybox/jquery.fancybox.pack-v=2.1.5.js"></script>
  <script src="js/script.js"></script>
  
  <!-- fancybox init -->
  <script>
  $(document).ready(function(e) {
    var lis = $('.nav > li');
    menu_focus( lis[0], 1 );
    
    $(".fancybox").fancybox({
      padding: 10,
      helpers: {
        overlay: {
          locked: false
        }
      }
    });


  

  });
  $('.scan-btn').on('click', scan);
  </script>
</html>
